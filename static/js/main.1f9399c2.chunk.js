(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{42:function(e,t,a){},67:function(e,t,a){e.exports=a(80)},72:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),o=a.n(c),l=(a(72),a(42),a(115)),s=a(15),i=a(106),m=a(111),u=a(114),g=a(117),h=a(56),d=a(109);function f(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(""),f=Object(s.a)(o,2),E=f[0],p=f[1],v=Object(n.useState)(!1),b=Object(s.a)(v,2),_=b[0],j=b[1],w=Object(n.useState)(""),O=Object(s.a)(w,2),y=O[0],N=O[1];if(E)return r.a.createElement(l.a,{to:{pathname:E,state:{name:a}}});var k=function(e){if(a.length){if(!(a.length>20))return p("/chat");N("Please enter a shorter name!"),j(!0)}else N("Please enter a non-empty name"),j(!0)},S=window.innerHeight,D=window.innerWidth,C=Object(h.a)({typography:{fontSize:.03*S}}),M=Object(h.a)({typography:{fontSize:.02*D+.02*S}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{maxWidth:"lg",className:"large_login_container"},r.a.createElement("section",{id:"login_container"},r.a.createElement("div",{id:"welcome"},"Welcome!"),r.a.createElement("div",{id:"info"},"This is a very simple chat site where you can connect with a unique name and chat with all other connect users! Made with:"),r.a.createElement("div",{id:"logos"},r.a.createElement("div",null,r.a.createElement("a",{href:"https://github.com/Ellipsoul",target:"_blank"},r.a.createElement("img",{src:"/images/github_logo.png",className:"logo"}))),r.a.createElement("div",null,r.a.createElement("a",{href:"https://reactjs.org/",target:"_blank"},r.a.createElement("img",{src:"/images/react_logo.png",className:"logo"}))),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.typescriptlang.org/",target:"_blank"},r.a.createElement("img",{src:"images/typescript_logo.png",className:"logo"}))),r.a.createElement("div",null,r.a.createElement("a",{href:"https://www.python.org/",target:"_blank"},r.a.createElement("img",{src:"/images/python_logo.png",className:"logo"}))),r.a.createElement("div",null,r.a.createElement("a",{href:"https://flask.palletsprojects.com/en/1.1.x/",target:"_blank"},r.a.createElement("img",{src:"/images/flask_logo.png",className:"logo"}))),r.a.createElement("div",null,r.a.createElement("a",{href:"https://aws.amazon.com/",target:"_blank"},r.a.createElement("img",{src:"/images/aws_logo.png",className:"logo"})))),r.a.createElement("div",{id:"name_login"},r.a.createElement("div",{className:"name_input"},r.a.createElement(d.a,{theme:C},r.a.createElement(m.a,{fullWidth:!0,multiline:!0,rows:1,value:a,onChange:function(e){return c(e.target.value)},variant:"outlined",color:"primary",placeholder:"Enter name",onKeyDown:function(e){"Enter"==e.key&&k()}}))),r.a.createElement("div",{className:"name_submit_div"},r.a.createElement(d.a,{theme:M},r.a.createElement(u.a,{variant:"contained",color:"primary",className:"name_button",onClick:k},"Start Chatting!"))),r.a.createElement(g.a,{color:"secondary",anchorOrigin:{vertical:"bottom",horizontal:"center"},open:_,onClose:function(){j(!1)},autoHideDuration:3e3,message:y})))))}var E=a(29),p=a(113),v=a(45),b=a.n(v),_=a(55);function j(e){var t=_.isMobile?b()(e.date).format("D/M  HH:mm"):b()(e.date).format("D MMMM YYYY  HH:mm:ss");return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{className:"message_container"},r.a.createElement("div",{className:"msg_name"}," ",e.name," "),r.a.createElement("div",{className:"msg_date"}," ",t," "),r.a.createElement("div",{className:"msg_message"}," ",e.message," ")))}function w(e){var t=Object(l.d)(),a=Object(n.useState)(""),c=Object(s.a)(a,2),o=c[0],h=c[1],d=Object(n.useState)(0),f=Object(s.a)(d,2),v=f[0],b=f[1],_=Object(n.useRef)(v);_.current=v;var w=Object(n.useState)(0),O=Object(s.a)(w,2),y=O[0],N=O[1],k=Object(n.useRef)(y);k.current=y;var S=function(e){e.preventDefault();var a=t.state.name,n=new Date(Date.now()),c=o,l=n.getTime();if(0!==o.length&&o.length<1e3){fetch("/api/send_message",{method:"POST",headers:{content_type:"application/json"},body:JSON.stringify({name:a,date:n.toString(),message:c,date_unix:l})}).then((function(e){return e.json()})),console.log("Message sent!"),h(""),N(k.current+1);var s=r.a.createElement(j,{key:k.current,name:a,date:n.toString(),message:c});return z((function(e){return[].concat(Object(E.a)(e),[s])})),b(l),!1}B(!0)};Object(n.useEffect)((function(){F()}),[]);var D=Object(n.useState)([[]]),C=Object(s.a)(D,2),M=C[0],x=C[1],H=Object(n.useRef)(M);H.current=M;var R=Object(n.useState)([[]]),W=Object(s.a)(R,2),T=W[0],z=W[1];function F(){fetch("/api/get_all_messages",{method:"GET",headers:{content_type:"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("Retrieved all messages from server"),x(e.all_messages);var t=e.all_messages.length;N(k.current+t),z(e.all_messages.map((function(e,a){return r.a.createElement(j,{key:k.current-t+a,name:e[0],date:e[1],message:e[2]})})))}))}function I(){if(!H.current.length)return F(),null;var e=parseInt(H.current[H.current.length-1][3])>_.current?H.current[H.current.length-1][3]:_.current.toString(),a="/api/get_new_messages?time=".concat(e);console.log("Getting new messages with query: ".concat(a," for user ").concat(t.state.name)),fetch(a,{method:"GET",headers:{content_type:"application/json"}}).then((function(e){return e.json()})).then((function(e){if(console.log("Retrieve new messages from server for user ".concat(t.state.name)),console.log("New messages are:"),console.log(e.new_messages),e.new_messages.length){x((function(t){return[].concat(Object(E.a)(t),Object(E.a)(e.new_messages))}));var a=e.new_messages.length;N(k.current+a);var n=e.new_messages.map((function(e,t){return r.a.createElement(j,{key:k.current-a+t,name:e[0],date:e[1],message:e[2]})}));z((function(e){return[].concat(Object(E.a)(e),Object(E.a)(n))}))}}))}var Y=Object(n.useRef)(null);Object(n.useEffect)((function(){Y.current.scrollIntoView({behavior:"smooth"})}),[T]);var G=window.innerHeight,A=Math.floor(G/200),J=Object(n.useState)(!1),P=Object(s.a)(J,2),q=P[0],B=P[1];Object(n.useEffect)((function(){var e=setInterval((function(){I()}),1e3);return function(){return clearInterval(e)}}),[]);var K=Object(n.useState)(!1),L=Object(s.a)(K,2),V=L[0],$=L[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{maxWidth:"lg",className:"large_chat_container",disableGutters:!0},r.a.createElement("section",{className:"chat_container"},r.a.createElement("div",{className:"chat_messages_container"},r.a.createElement("div",{className:"chat_messages_div"},T,r.a.createElement("div",{ref:Y}))),r.a.createElement("div",{id:"input_field_div"},r.a.createElement(p.a,{width:"100%"},r.a.createElement(m.a,{label:"Say something, ".concat(t.state.name," :)"),fullWidth:!0,multiline:!0,rows:A,value:o,onChange:function(e){return h(e.target.value)},variant:"outlined",color:"primary",onKeyDown:function(e){"Enter"==e.key&&S(e)}}))),r.a.createElement(g.a,{color:"secondary",anchorOrigin:{vertical:"bottom",horizontal:"center"},open:q,onClose:function(){B(!1)},autoHideDuration:3e3,message:"Your message is either empty or too long!"}),r.a.createElement("div",{className:"submit_button_div"},r.a.createElement(u.a,{variant:"contained",color:"primary",className:"submit_button",onClick:S},r.a.createElement("span",{id:"submit_button_text"}," Send "))))),r.a.createElement("button",{className:"hidden_button",onClick:function(){console.log("Dev menu toggled"),$(!V)}},"D"),V?r.a.createElement("div",{className:"dev_buttons_div"},r.a.createElement("button",{onClick:function(){fetch("/api/clear_messages",{method:"DELETE",headers:{content_type:"application/json"}}).then((function(){console.log("All messages deleted!")}))}},"DA"),r.a.createElement("button",{onClick:function(){var e=Date.now(),t="api/clear_old_messages?time=".concat(e);fetch(t,{method:"DELETE",headers:{content_type:"application/json"}}).then((function(){console.log("Old messages deleted!")}))}},"DO"),r.a.createElement("button",{onClick:F},"RA"),r.a.createElement("button",{onClick:I},"RN")):null)}var O=function(){return console.log("Frontend is now running!"),r.a.createElement(r.a.Fragment,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,from:"/",to:"/login"}," "),r.a.createElement(l.b,{exact:!0,path:"/login",component:f}),r.a.createElement(l.b,{exact:!0,path:"/chat",component:w})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[67,1,2]]]);
//# sourceMappingURL=main.1f9399c2.chunk.js.map